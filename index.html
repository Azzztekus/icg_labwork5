<!DOCTYPE html>
<html lang="ru">
<head>  
  <meta charset="utf-8" />
  <title>Лабораторная работа 5</title>
  <link rel="stylesheet" href="https://www.x3dom.org/download/dev/x3dom.css" />
  <script src="https://www.x3dom.org/download/dev/x3dom.js"></script>
  <link rel="stylesheet" href="./css/custom.css" />
  <script src="./js/custom.js"></script>
</head>

<body>
  <h1>Скоро космос будет наш</h1>

  <script>
    function start() {
      var ts=document.getElementById("time1");
      var StT=Math.round(new Date().getTime()/1000);
      var EnT=StT + ts.getAttribute("cycleInterval");

      var but=document.getElementById("but1");

      var check=ts.getAttribute("enabled");
      if (check == "true"){
        ts.setAttribute("enabled", "false");
        but.value = ("Перезапуск");
      }
      else{
        ts.setAttribute("startTime", StT);
        ts.setAttribute("stopTime", EnT);
        ts.setAttribute("enabled", "true");
        but.value = ("Стоп");
      }
    }
  </script>
  <script>
    function remove() {
      var ts=document.getElementById("time2");
      var StT=Math.round(new Date().getTime()/1000);
      var EnT=StT + ts.getAttribute("cycleInterval");
      var check=ts.getAttribute("enabled");
      if (check == "true"){
        ts.setAttribute("enabled", "false");
      }
      else{
        ts.setAttribute("startTime", StT);
        ts.setAttribute("stopTime", EnT);
        ts.setAttribute("enabled", "true");
      }
    }
  </script>
  <X3D style="width:720px; height:480px">
    <scene>
      <input type="button" id="but1" value="Старт" onclick="start()"></input>
      <input type="button" id="but2" value="Отсоединить ускорители" onclick="remove()"></input>
      <group def="ground">
        <transform translation='0 0 0'>
          <Shape>
            <Appearance>
              <ImageTexture url=".\concrete.jpg"> </ImageTexture>
            </Appearance>
            <Box size='200 2 200' > </Box>  
          </Shape>
        </transform>
        <transform translation='10 0 0'>
          <transform translation='0 2 0'>
            <Shape>
              <Appearance>
                <Material diffuseColor="brown"></Material>
              </Appearance>
              <Box size='20 2.25 10' > </Box>  
            </Shape>
          </transform>
          <transform translation='6 12 0'>
            <Shape>
              <Appearance>
                <Material diffuseColor="brown"></Material>
              </Appearance>
              <Box size='3 20 3' > </Box>  
            </Shape>
          </transform>
        </transform>
      </group>
      <transform translation='10 0 0'>
      <group def="rocket">
        <transform translation='10 0 0' DEF='launch'>
          <transform translation='0 22 0'>
            <Shape>
              <Appearance>
                <Material diffuseColor="white"></Material>
              </Appearance>
              <Cone size="20 40"></Cone>
            </Shape>
          </transform>
          <transform translation='0 12.5 0'>
            <Shape>
              <Appearance>
                <ImageTexture url=".\spaceshiptext.png"> </ImageTexture>
              </Appearance>
              <Cylinder height='17' radius='1'> </Cylinder>
            </Shape>
          </transform>
          <transform translation='0 4 0'>
            <Shape>
              <Appearance>
                <Material diffuseColor="black"></Material>
              </Appearance>
              <Cone size="20 40"></Cone>
            </Shape>
          </transform>
          <transform translation='0 18 0' rotation='1 0 0 -1.414'>
            <Shape>
              <Appearance>
                <Material diffuseColor="black"></Material>
              </Appearance>
              <Torus innerradius='0.5' outerradius='0.6'> </Torus>
            </Shape>
          </transform>
          <transform translation='0 10 0' rotation='1 0 0 -1.414'>
            <Shape>
              <Appearance>
                <Material diffuseColor="black"></Material>
              </Appearance>
              <Torus innerradius='0.5' outerradius='0.6'> </Torus>  
            </Shape>
          </transform>
          <transform translation='0 19 0'>
            <Shape>
              <Appearance>
                <Material diffuseColor="yellow"></Material>
              </Appearance>
              <Box size='4 0.2 0.05' > </Box>  
            </Shape>
          </transform>
          <!--1 ускоритель-->
          <transform def="accelerator_1">
            <transform translation='-1 15 0'>
              <Shape>
                <Appearance>
                 <ImageTexture url=".\spaceshiptext.png"> </ImageTexture>
               </Appearance>
               <Cylinder height='5' radius='0.2'> </Cylinder>
             </Shape>
           </transform>
           <transform translation='-1.5 17.5 0'>
             <Shape>
              <Appearance>
                <Material diffuseColor="white"></Material>
              </Appearance>
              <Cone height='2' bottomradius='0.5'></Cone>
            </Shape>
          </transform>
          <transform translation='-1.5 10 0'>
            <Shape>
              <Appearance>
               <ImageTexture url=".\spaceshiptext.png"> </ImageTexture>
             </Appearance>
             <Cylinder height='13' radius='0.5'> </Cylinder>
           </Shape>
         </transform>
         <transform translation='-1.5 4 0'>
          <Shape>
            <Appearance>
              <Material diffuseColor="black"></Material>
            </Appearance>
            <Cone height='2' bottomradius='0.5'></Cone>
          </Shape>
        </transform>
      </transform>
      <!--2 ускоритель-->
      <transform def="accelerator_2">
        <transform translation='1 15 0'>
          <Shape>
            <Appearance>
             <ImageTexture url=".\spaceshiptext.png"> </ImageTexture>
           </Appearance>
           <Cylinder height='5' radius='0.2'> </Cylinder>
         </Shape>
       </transform>  
       <transform translation='1.5 17.5 0'>
        <Shape>
          <Appearance>
            <Material diffuseColor="white"></Material>
          </Appearance>
          <Cone height='2' bottomradius='0.5'></Cone>
        </Shape>
      </transform>
      <transform translation='1.5 10 0'>
        <Shape>
          <Appearance>
           <ImageTexture url=".\spaceshiptext.png"> </ImageTexture>
         </Appearance>
         <Cylinder height='13' radius='0.5'> </Cylinder>
       </Shape>
     </transform>
     <transform translation='1.5 4 0'>
      <Shape>
        <Appearance>
          <Material diffuseColor="black"></Material>
        </Appearance>
        <Cone height='2' bottomradius='0.5'></Cone>
      </Shape>
    </transform>
  </transform>
</transform>
</group>
</transform>


<Background groundAngle='0.9 1.5 1.57' groundColor='0.6 0.3 0.1 0.2 0.1 0.2 0.1 0.6 0.1 0 0.3 0.1' skyAngle='0.9 1.5 1.57' skyColor='0.28 0.18 0.36 0.2 0.44 0.85 0.51 0.81 0.95 0.47 0.8 0.2'></Background>
<SpotLight ambientIntensity='0' attenuation='1,0,0' beamWidth='1.5707963' color='1,1,1' cutOffAngle='1.5707963' direction='0,0,-1'  intensity='1' location='-40 10 10' radius='100'> 
</SpotLight>
<Fog visibilityRange='200' fogType='EXPONENTIAL'></Fog>

<Viewpoint position="-10 2 500" orientation="0 1 0 0"></Viewpoint>
<Viewpoint def="camera"></Viewpoint>


<timeSensor DEF="time1" id="time1" cycleInterval="60" loop="false" enabled="false" startTime="0" stopTime="0"> 
</timeSensor>

<timeSensor DEF="time2" id="time2" cycleInterval="5" loop="false" enabled="false">
</timeSensor>

<OrientationInterpolator DEF="angle" key="0 0.3 0.5 0.8 1" keyValue="0 0 0 0, 0 0 0 0, 1 0 0 -0.707, 1 0 0 -1.5707963, 1 0 0 -1.5707963"
></OrientationInterpolator> 
<PositionInterpolator DEF="force" key="0 0.05 0.1 0.3 0.5 0.7 0.9 1" keyValue="0 0 0, 0 0 0, 0 30 0, 0 125 0, 0 175 -20, 0 225 -50, 0 225 -100, 0 225 -150"> 
</PositionInterpolator> 
<PositionInterpolator DEF="view" key="0 0.05 0.1 0.3 0.5 0.7 0.9 1" keyValue="10 15 50, 10 15 50, 10 40 50, 10 135 50, 10 185 30, 10 235 0, 10 235 -50, 10 235 -100"> 
</PositionInterpolator> 

<PositionInterpolator DEF="remove_1" key="0 0.25 0.5 0.75 1" keyValue="0 0 0, -10 0 0, -25 0 0, -50 0 0, -75 0 0"> 
</PositionInterpolator> 
<PositionInterpolator DEF="remove_2" key="0 0.25 0.5 0.75 1" keyValue="0 0 0, 10 0 0, 25 0 0, 50 0 0, 75 0 0"> 
</PositionInterpolator> 
<PositionChaser DEF="PosCh" duration="1"></PositionChaser>
<PositionDamper DEF="PosDm" duration="1"></PositionDamper>

<Route fromNode="time1"  fromField ="fraction_changed" toNode="force"  toField="set_fraction"> </Route>
<Route fromNode="time1"  fromField ="fraction_changed" toNode="view"   toField="set_fraction"> </Route>
<Route fromNode="time1"  fromField ="fraction_changed" toNode="angle"  toField="set_fraction"> </Route> 
<Route fromNode="force"  fromField ="value_changed"    toNode="PosCh"  toField="set_destination"> </Route>
<Route fromNode="view"   fromField ="value_changed"    toNode="PosDm"  toField="set_destination"> </Route>

<Route fromNode="PosCh"  fromField ="value_changed"    toNode="launch" toField="translation">  </Route> 
<Route fromNode="PosDm"  fromField ="value_changed"    toNode="camera" toField="position">     </Route>
<Route fromNode="angle"  fromField ="value_changed"    toNode="launch" toField="set_rotation"> </Route> 



<Route fromNode="time2"    fromField ="fraction_changed" toNode="remove_1"       toField="set_fraction"> </Route>
<Route fromNode="time2"    fromField ="fraction_changed" toNode="remove_2"       toField="set_fraction"> </Route>
<Route fromNode="remove_1" fromField ="value_changed"    toNode="accelerator_1"  toField="set_translation">  </Route>
<Route fromNode="remove_2" fromField ="value_changed"    toNode="accelerator_2"  toField="set_translation">  </Route>

</scene>
</X3D>
</body> 
</html>
